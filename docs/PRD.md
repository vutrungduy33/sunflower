# 泸沽湖民宿后台管理系统 + 微信小程序 需求规格与开发计划

> 目标：建设“民宿后台管理系统 + 微信小程序”，实现住客服务闭环与 OTA 转私域，同时为泸沽湖游客提供更便利的公共服务（地图/景点/点评/游记）。

## 1. 项目范围与角色

### 1.1 角色
- **游客/住客用户**：浏览与下单、查看攻略、分享游记与点评  
- **民宿运营**：房态/订单/客诉/内容/渠道与财务管理  
- **商家合作方**：餐饮/猪槽船等服务方  
- **系统管理员**：权限/配置/数据分析

### 1.2 业务目标
- **转私域**：通过小程序减少 OTA 复购依赖，提升直订占比与复购率  
- **效率提升**：降低人工对接与重复沟通，提升前台/客服效率  
- **体验提升**：一站式吃住行游购娱

## 2. 需求清单（含优先级）

### P0（必须）
1. **房型/房态/价格展示**（小程序）
   - 房型列表、价格日历、可售库存、入住/退房规则
2. **订单管理（入住/退房）**（小程序 + 后台）
   - 下单、支付、取消/改期、入住核销  
3. **后台房态与价格管理**
   - 房型、库存、房价日历、促销规则  
4. **基础用户体系**
   - 微信登录、手机号绑定、用户标签（亲子/情侣/摄影等）  
5. **订单与支付对账**
   - 微信支付、退款、对账报表  
6. **内容基础**
    - 民宿介绍、位置与交通说明、客服联系方式  
7. **私域转化入口**
   - 入住引导二维码、Wi‑Fi 弹窗引导、小程序订房专属权益  
8. **客源归因与标签**
   - 订单来源（OTA/直订/线下）、首住/复购标记、客群标签  

### P1（高优先）
1. **餐饮/商品点单**（小程序 + 后台）
   - 菜单、库存、下单、出单、配送/自取  
2. **泸沽湖地图 + 景点推荐**
   - POI 列表、路线规划、附近推荐  
3. **猪槽船/接驳服务预订**
   - 时间段预订、人数/票务、折扣管理  
4. **评价与分享**
   - 入住评价、景点评价、图片/游记分享  
5. **优惠券/会员权益**
    - 首单券、复购券、淡季券  
6. **私域触达与再营销**
   - 入住后自动发券、节假日触达、老客唤醒  
7. **会员成长体系**
   - 等级/积分/权益包（延迟退房、接驳优惠等）  

### P2（可延后）
1. **活动与主题团**
   - 摄影团/亲子团/旅居计划报名  
2. **数据分析面板**
   - 订单/客源/渠道/房型维度分析  
3. **CRM 与私域触达**
   - 关注提醒、节假日营销、再营销人群包  
4. **多店扩展**
   - 未来多民宿接入与运营

## 3. 需求规格说明（核心模块）

### 3.1 小程序端
1. **房型展示与预订**
   - 列表 + 详情 + 日历价 + 下单 + 支付  
2. **订单中心**
   - 待入住/已入住/已完成/退款/改期  
3. **餐饮与商品点单**
   - 菜单分类、商品详情、下单、配送状态  
4. **泸沽湖地图与攻略**
   - 景点列表、路线建议、附近美食/打卡点  
5. **游记与点评**
   - 图文发布、点赞收藏、举报  
6. **服务中心**
    - 接驳/猪槽船/客服  
7. **私域权益入口**
   - 会员权益、专属券、复购入口  

### 3.2 后台管理
1. **房态/房价管理**
   - 房型、价格日历、库存、促销  
2. **订单管理**
   - 下单/入住/取消/退款/改期  
3. **餐饮/商品管理**
   - 菜单/商品、库存、出单  
4. **内容管理**
   - 景点/攻略/游记审核  
5. **用户与会员**
    - 用户标签、优惠券、权益  
6. **财务与报表**
    - 收入、退款、支付对账  
7. **私域运营**
    - 触达计划、活动配置、渠道归因分析  

## 4. 软件架构（建议）

### 4.0 技术栈选择（确认）
- **后端**：Java / Spring Boot（单体，开发环境基于 docker-compose）  
- **数据库**：MySQL  
- **前端**：微信小程序（原生）  
- **后台管理**：Web（技术栈待落地）  

### 4.1 架构模式
- **前端**：微信小程序  
- **后台管理**：Web 管理后台  
- **服务端**：REST API（Spring Boot 单体）  
- **数据存储**：MySQL + 对象存储  

### 4.2 模块划分（单体内模块）
- **用户与认证模块**  
- **订单与支付模块**  
- **房态与价格模块**  
- **餐饮/商品模块**  
- **内容与点评模块**  
- **营销与优惠券模块**  
- **统计分析模块**

## 5. 数据库设计（核心表）

### 5.1 用户与权限
- `users`（用户）
- `roles` / `user_roles`
- `user_profiles`

### 5.2 房态与订单
- `rooms`（房型）
- `room_inventory`（库存/日期）
- `room_prices`（价格日历）
- `orders` / `order_items`
- `payments` / `refunds`

### 5.3 餐饮与商品
- `products` / `product_categories`
- `product_inventory`
- `food_orders`

### 5.4 内容与点评
- `poi`（景点/餐饮/打卡点）
- `posts`（游记）
- `reviews`（评论）
- `media_assets`

### 5.5 营销
- `coupons`
- `coupon_redemptions`
- `campaigns`

## 6. 部署方案（建议）

### 6.1 部署架构
- **前端**：微信小程序发布  
- **后端服务**：容器化部署（本地/测试使用 docker-compose）  
- **数据库**：MySQL  
- **对象存储**：用于图片/视频  

### 6.2 运维与监控
- 日志系统、告警、备份与恢复  
- 灰度发布与版本管理  

## 7. 开发计划（里程碑）

### M1（0-4 周）：P0
- 房态/订单/支付/基础内容  

### M2（4-8 周）：P1
- 餐饮点单、景点地图、猪槽船/接驳、评价分享  

### M3（8-12 周）：P2
- 活动/CRM/数据分析  

## 8. 风险与依赖
- 微信支付/小程序审核周期  
- OTA 数据迁移与私域触达合规  
- 内容审核与侵权风险  
- 用户隐私与授权合规（手机号/营销触达）

## 9. 私域化必要功能清单（建议）

### 9.1 转化入口（必须）
- 入住引导二维码（前台/房间）  
- Wi‑Fi 登录页引导  
- 小程序专属价/券  

### 9.2 用户沉淀（必须）
- 微信登录 + 手机号绑定  
- 订单来源记录（OTA/直订/线下）  
- 基础标签（亲子/情侣/旅居）  

### 9.3 复购与唤醒（高优先）
- 入住后自动发券（复购券/淡季券）  
- 节假日营销触达  
- 老客二次下单提醒  

### 9.4 会员权益（高优先）
- 会员等级/积分  
- 权益包（延迟退房、接驳折扣、猪槽船折扣）  

### 9.5 数据与看板（高优先）
- 私域转化漏斗（扫码 → 注册 → 下单 → 复购）  
- 渠道效果对比（OTA vs 直订）  

## 10. 私域化细化说明（页面级功能 / 埋点事件 / 指标口径）

### 10.1 页面级功能（小程序）

**A. 入住引导页（扫码入口/弹窗）**
- 目的：把 OTA 客户沉淀为私域用户  
- 功能：扫码进入小程序、领取专属券、绑定手机号  

**B. 我的-会员中心**
- 会员等级/积分/权益包  
- 我的优惠券（可用/已用/过期）  
- 复购入口（“一键续住/再订”）  

**C. 订单详情页**
- 显示订单来源（OTA/直订/线下）  
- 完成订单后弹出“复购券”  

**D. 服务中心**
- 接驳/猪槽船预订入口  
- 触达提示（“专属折扣”标签）  

### 10.2 页面级功能（后台）

**A. 私域看板**
- 扫码人数/注册人数/绑定手机号数  
- 直订订单占比、复购率  
- 会员活跃与券核销  

**B. 触达计划**
- 入住后发券  
- 节假日触达  
- 老客唤醒  

**C. 用户标签管理**
- 来源标签（OTA/直订/线下）  
- 客群标签（亲子/旅居/情侣）  
- 价格敏感度标签  

### 10.3 埋点事件（MVP 级）

**转化入口事件**
- `qr_scan`（扫码进入）  
- `wx_login_success`（微信登录）  
- `bind_phone_success`（手机号绑定）  
- `coupon_claim`（券领取）  

**下单与复购事件**
- `room_view`（房型浏览）  
- `order_create`（创建订单）  
- `order_pay_success`（支付成功）  
- `order_complete`（完成订单）  
- `rebook_click`（复购点击）  

**运营触达事件**
- `campaign_sent`（触达发送）  
- `campaign_click`（触达点击）  

### 10.4 指标口径（建议）

**私域转化漏斗**
- **扫码转化率** = 绑定手机号人数 / 扫码人数  
- **首单转化率** = 直订首单人数 / 绑定手机号人数  
- **复购率** = 复购用户数 / 直订用户数  

**私域经营指标**
- **直订占比** = 直订订单数 / 总订单数  
- **券核销率** = 核销券数量 / 领取券数量  
- **触达转化率** = 触达点击人数 / 触达发送人数  

**口径说明**
- 直订：小程序/线下引导下单  
- OTA：平台订单（携程/飞猪/美团等）  

## 11. 埋点字段字典（事件属性）

> 用于数据埋点与分析。所有事件建议包含以下公共字段：
> `user_id`、`session_id`、`event_time`、`device`、`platform`、`channel`。

### 11.1 公共属性
- `user_id`：用户 ID  
- `session_id`：会话 ID  
- `event_time`：事件时间  
- `device`：设备型号  
- `platform`：ios/android  
- `channel`：来源渠道（OTA/直订/线下/扫码）  

### 11.2 关键事件属性

**A. 扫码 / 登录 / 绑定**
- `qr_scan`：`qr_id`、`scene`（前台/房间/Wi‑Fi）  
- `wx_login_success`：`wechat_openid`  
- `bind_phone_success`：`phone_hash`  

**B. 浏览与下单**
- `room_view`：`room_id`、`price`、`checkin_date`、`checkout_date`  
- `order_create`：`order_id`、`amount`、`room_id`、`source`  
- `order_pay_success`：`order_id`、`pay_amount`、`pay_channel`  
- `order_complete`：`order_id`、`nights`、`total_amount`  
- `rebook_click`：`room_id`、`from_order_id`  

**C. 券与营销**
- `coupon_claim`：`coupon_id`、`coupon_type`  
- `coupon_used`：`coupon_id`、`order_id`  
- `campaign_sent`：`campaign_id`  
- `campaign_click`：`campaign_id`  

## 12. 数据看板字段表（示例）

### 12.1 私域转化漏斗
| 指标 | 说明 | 口径 |
|---|---|---|
| 扫码人数 | 进入小程序人数 | `qr_scan` 去重 `user_id` |
| 绑定人数 | 绑定手机号人数 | `bind_phone_success` 去重 `user_id` |
| 首单人数 | 首次直订人数 | 首次 `order_pay_success` 且 `source=direct` |
| 复购人数 | 直订复购人数 | 同用户 ≥ 2 次直订 |

### 12.2 私域运营指标
| 指标 | 说明 | 口径 |
|---|---|---|
| 直订占比 | 直订订单占比 | 直订订单数 / 总订单数 |
| 复购率 | 直订复购率 | 复购人数 / 直订人数 |
| 券核销率 | 券使用效率 | `coupon_used` / `coupon_claim` |
| 触达点击率 | 触达效果 | `campaign_click` / `campaign_sent` |

## 13. 相关文档
- 信息架构：`docs/IA.md`
- 关键流程：`docs/Flows.md`
- 接口清单：`docs/API.md`
- 接口字段定义：`docs/API-Schemas.md`
- 数据字典：`docs/DataDictionary.md`
- 数据库索引与约束：`docs/DB-Design.md`
- MVP 原型页：`docs/Prototype.md`
- Sprint Backlog：`docs/Backlog.md`
- 埋点与报表：`docs/Analytics.md`
- CI/CD 部署：`docs/CI-CD.md`
